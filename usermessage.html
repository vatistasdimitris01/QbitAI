<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Editable Message</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* Define the CSS variable used in the HTML */
      :root {
        --content-max-width: 800px;
      }
      body {
        background-color: #f0f2f5; /* A light grey background to see the component */
        padding: 2rem;
      }
      .dark body {
        background-color: #1a1a1a;
      }
    </style>
  </head>
  <body>
    <!-- Combined Component -->
    <div class="flex flex-col items-center">
      <!-- ======================= 1. Display View (Initially Visible) ======================= -->
      <div id="display-view" class="w-full">
        <div
          class="relative group flex flex-col justify-center w-full max-w-[var(--content-max-width)] pb-0.5 items-end"
        >
          <div
            dir="auto"
            class="message-bubble rounded-3xl text-primary min-h-7 prose dark:prose-invert break-words prose-p:opacity-100 prose-strong:opacity-100 prose-li:opacity-100 prose-ul:opacity-100 prose-ol:opacity-100 prose-ul:my-1 prose-ol:my-1 prose-li:my-2 last:prose-li:mb-3 prose-li:ps-1 prose-li:ms-1 bg-surface-l2 border border-border-l1 max-w-[100%] sm:max-w-[90%] px-4 py-2.5 rounded-br-lg rounded-bl-lg"
          >
            <div class="relative">
              <span id="message-text" class="whitespace-pre-wrap">hi</span>
              <section
                class="inline-media-container flex flex-col gap-1"
              ></section>
              <section class="auth-notification flex flex-col gap-1"></section>
            </div>
          </div>
          <div
            style="height: 1px; position: absolute; bottom: 0px; z-index: 1000"
          ></div>
          <div
            class="order-first sticky hidden @md/mainview:block top-11 h-0 opacity-0 group-focus-within:opacity-100 group-hover:opacity-100 -mr-[36px] @lg/mainview:-mr-12"
          >
            <div class="min-h-7 py-4 flex flex-col gap-0.5"></div>
          </div>
          <div
            class="action-buttons h-8 mt-0.5 flex flex-row flex-wrap w-full justify-end print:hidden"
          >
            <div
              class="flex items-center gap-[2px] w-max rounded-lg text-xs px-2 end-4 -mr-2"
            >
              <!-- The Edit Button -->
              <button
                id="edit-btn"
                class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium leading-[normal] cursor-pointer focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed transition-colors duration-100 [&amp;_svg]:shrink-0 select-none text-fg-secondary hover:text-fg-primary hover:bg-button-ghost-hover disabled:hover:text-fg-secondary disabled:hover:bg-transparent [&amp;_svg]:hover:text-fg-primary h-8 w-8 rounded-full opacity-0 group-focus-within:opacity-100 group-hover:opacity-100 [.last-response_&amp;]:opacity-100 disabled:opacity-0 group-focus-within:disabled:opacity-60 group-hover:disabled:opacity-60 [.last-response_&amp;]:disabled:opacity-60"
                type="button"
                aria-label="Edit"
                data-state="closed"
              >
                <span style="opacity: 1; transform: none">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                    class="stroke-[2] size-4"
                  >
                    <path
                      d="M18.25 5.75C16.8693 4.36929 14.6307 4.36929 13.25 5.75L10.125 8.875L5.52404 13.476C4.86236 14.1376 4.45361 15.0104 4.36889 15.9423L4 20.0001L8.0578 19.6311C8.98967 19.5464 9.86234 19.1377 10.524 18.476L18.25 10.75C19.6307 9.36929 19.6307 7.13071 18.25 5.75V5.75Z"
                      stroke="currentColor"
                    ></path>
                    <path
                      d="M12.5 7.5L16.5 11.5"
                      stroke="currentColor"
                    ></path></svg
                ></span>
              </button>
              <!-- The Copy Button -->
              <button
                class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium leading-[normal] cursor-pointer focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed transition-colors duration-100 [&amp;_svg]:shrink-0 select-none text-fg-secondary hover:text-fg-primary hover:bg-button-ghost-hover disabled:hover:text-fg-secondary disabled:hover:bg-transparent [&amp;_svg]:hover:text-fg-primary h-8 w-8 rounded-full opacity-0 group-focus-within:opacity-100 group-hover:opacity-100 [.last-response_&amp;]:opacity-100 disabled:opacity-0 group-focus-within:disabled:opacity-60 group-hover:disabled:opacity-60 [.last-response_&amp;]:disabled:opacity-60"
                type="button"
                aria-label="Copy"
                data-state="closed"
              >
                <span style="opacity: 1; transform: none">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                    class="stroke-[2] size-4"
                  >
                    <path
                      d="M8 5C8 4.44772 8.44772 4 9 4H17C17.5523 4 18 4.44772 18 5V19C18 19.5523 17.5523 20 17 20H9C8.44772 20 8 19.5523 8 19V5Z"
                      stroke="currentColor"
                      stroke-width="1.5"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    ></path>
                    <path
                      d="M16 4V3C16 2.44772 15.5523 2 15 2H7C6.44772 2 6 2.44772 6 3V17C6 17.5523 6.44772 18 7 18H8"
                      stroke="currentColor"
                      stroke-width="1.5"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    ></path>
                  </svg>
                </span>
              </button>
              <!-- The Copy Button -->
              <button
                class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium leading-[normal] cursor-pointer focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed transition-colors duration-100 [&amp;_svg]:shrink-0 select-none text-fg-secondary hover:text-fg-primary hover:bg-button-ghost-hover disabled:hover:text-fg-secondary disabled:hover:bg-transparent [&amp;_svg]:hover:text-fg-primary h-8 w-8 rounded-full opacity-0 group-focus-within:opacity-100 group-hover:opacity-100 [.last-response_&amp;]:opacity-100 disabled:opacity-0 group-focus-within:disabled:opacity-60 group-hover:disabled:opacity-60 [.last-response_&amp;]:disabled:opacity-60"
                type="button"
                aria-label="Copy"
                data-state="closed"
              >
                <span style="opacity: 1; transform: none"
                  ><svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                    class="stroke-[2] size-4"
                  >
                    <rect
                      x="3"
                      y="8"
                      width="13"
                      height="13"
                      rx="4"
                      stroke="currentColor"
                    ></rect>
                    <path
                      fill-rule="evenodd"
                      clip-rule="evenodd"
                      d="M13 2.00004L12.8842 2.00002C12.0666 1.99982 11.5094 1.99968 11.0246 2.09611C9.92585 2.31466 8.95982 2.88816 8.25008 3.69274C7.90896 4.07944 7.62676 4.51983 7.41722 5.00004H9.76392C10.189 4.52493 10.7628 4.18736 11.4147 4.05768C11.6802 4.00488 12.0228 4.00004 13 4.00004H14.6C15.7366 4.00004 16.5289 4.00081 17.1458 4.05121C17.7509 4.10066 18.0986 4.19283 18.362 4.32702C18.9265 4.61464 19.3854 5.07358 19.673 5.63807C19.8072 5.90142 19.8994 6.24911 19.9488 6.85428C19.9992 7.47112 20 8.26343 20 9.40004V11C20 11.9773 19.9952 12.3199 19.9424 12.5853C19.8127 13.2373 19.4748 13.8114 19 14.2361V16.5829C20.4795 15.9374 21.5804 14.602 21.9039 12.9755C22.0004 12.4907 22.0002 11.9334 22 11.1158L22 11V9.40004V9.35725C22 8.27346 22 7.3993 21.9422 6.69141C21.8826 5.96256 21.7568 5.32238 21.455 4.73008C20.9757 3.78927 20.2108 3.02437 19.27 2.545C18.6777 2.24322 18.0375 2.1174 17.3086 2.05785C16.6007 2.00002 15.7266 2.00003 14.6428 2.00004L14.6 2.00004H13Z"
                      fill="currentColor"
                    ></path></svg
                ></span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- ======================= 2. Edit View (Initially Hidden) ======================= -->
      <div id="edit-view" class="w-full hidden">
        <div
          class="relative group flex flex-col justify-center w-full max-w-[var(--content-max-width)] pb-0.5 items-end"
        >
          <div
            dir="auto"
            class="message-bubble rounded-3xl text-primary min-h-7 prose dark:prose-invert break-words prose-p:opacity-100 prose-strong:opacity-100 prose-li:opacity-100 prose-ul:opacity-100 prose-ol:opacity-100 prose-ul:my-1 prose-ol:my-1 prose-li:my-2 last:prose-li:mb-3 prose-li:ps-1 prose-li:ms-1 bg-surface-l2 border border-border-l1 max-w-[100%] sm:max-w-[90%] px-4 py-2.5 rounded-br-lg"
          >
            <div class="flex flex-col w-full gap-2">
              <textarea
                id="message-textarea"
                dir="auto"
                class="w-full bg-transparent focus:outline-none text-primary"
                placeholder="Enter prompt here"
                style="resize: none"
              ></textarea>
              <div class="flex flex-row justify-end w-full gap-2 p-1">
                <!-- The Cancel Button -->
                <button
                  id="cancel-btn"
                  class="inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium cursor-pointer focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:opacity-60 disabled:cursor-not-allowed transition-colors duration-100 [&amp;_svg]:shrink-0 select-none text-fg-primary hover:bg-button-ghost-hover disabled:hover:bg-transparent border border-transparent h-8 rounded-xl px-3 text-xs"
                  type="button"
                >
                  Cancel
                </button>
                <!-- The Save Button -->
                <button
                  id="save-btn"
                  class="inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium cursor-pointer focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:opacity-60 disabled:cursor-not-allowed transition-colors duration-100 [&amp;_svg]:shrink-0 select-none bg-button-filled text-fg-invert hover:bg-button-filled-hover disabled:hover:bg-button-filled h-8 rounded-xl px-3 text-xs"
                  type="button"
                >
                  Save
                </button>
              </div>
            </div>
          </div>
          <div
            style="height: 1px; position: absolute; bottom: 0px; z-index: 1000"
          ></div>
        </div>
      </div>
    </div>

    <!-- ======================= JAVASCRIPT LOGIC ======================= -->
    <script>
      // Get references to all the necessary elements
      const displayView = document.getElementById("display-view");
      const editView = document.getElementById("edit-view");

      const editButton = document.getElementById("edit-btn");
      const cancelButton = document.getElementById("cancel-btn");
      const saveButton = document.getElementById("save-btn");

      const messageText = document.getElementById("message-text");
      const messageTextarea = document.getElementById("message-textarea");

      // Function to automatically adjust textarea height based on content
      const autoResizeTextarea = (element) => {
        element.style.height = "auto"; // Temporarily shrink to get the correct scrollHeight
        element.style.height = element.scrollHeight + "px"; // Set the height to the scroll height
      };

      // --- Event Listeners ---

      // 1. When the "Edit" button is clicked
      editButton.addEventListener("click", () => {
        // Hide display view and show edit view
        displayView.classList.add("hidden");
        editView.classList.remove("hidden");

        // Copy the current text from the span to the textarea
        messageTextarea.value = messageText.innerText;

        // Automatically resize the textarea and focus on it for a good user experience
        autoResizeTextarea(messageTextarea);
        messageTextarea.focus();
      });

      // 2. When the "Save" button is clicked
      saveButton.addEventListener("click", () => {
        // Update the display text with the new value from the textarea
        messageText.innerText = messageTextarea.value;

        // Hide edit view and show the display view again
        editView.classList.add("hidden");
        displayView.classList.remove("hidden");
      });

      // 3. When the "Cancel" button is clicked
      cancelButton.addEventListener("click", () => {
        // Discard changes and just switch back to the display view
        editView.classList.add("hidden");
        displayView.classList.remove("hidden");
      });

      // 4. (Optional but recommended for UX) Adjust textarea height as the user types
      messageTextarea.addEventListener("input", () => {
        autoResizeTextarea(messageTextarea);
      });
    </script>
  </body>
</html>
